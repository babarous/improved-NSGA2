function dx = rigidnd(t,x)
global k
dx = zeros(4,1);
iw=1.71e-3;
rw=0.075;
mb=0.042;
rb=0.011;
Ra=0.6558;
km=0.0662;
g=9.81;
a=(-2*rw*(km^2))/(Ra*(7*iw+2*(rw^2)*mb)*(rb+rw));
b=(g*(5*iw+2*(rw^2)*mb))/((7*iw+2*(rw^2)*mb)*(rb+rw));
c=(2*rw*km)/(Ra*(7*iw+2*(rw^2)*mb)*(rb+rw));
p=(-7*(km^2))/(Ra*(7*iw+2*(rw^2)*mb));
q=(2*g*rw*mb)/(7*iw+2*(rw^2)*mb);
r=(7*km)/(Ra*(7*iw+2*(rw^2)*mb));
lf4=-(b*r-c*q)*(x(2)^2)*sin(x(1))+(b*r-c*q)*(a*x(4)+b*sin(x(1)))*cos(x(1));
lglf3=c*(b*r-c*q)*cos(x(1));
y1=r*x(1)-c*x(3);
y2=r*x(2)-c*x(4);
y3=(b*r-c*q)*sin(x(1));
y4=(b*r-c*q)*x(2)*cos(x(1));
v=-k(1)*y1-k(2)*y2-k(3)*y3-k(4)*y4;
u=(1/lglf3)*(v-lf4);
dx(1)=x(2);
dx(2)=a*x(4)+b*sin(x(1))+c*u;
dx(3)=x(4);
dx(4)=p*x(4)+q*sin(x(1))+r*u;